<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Paneli - Sözlük Yönetimi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 30px;
            color: #fff;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header Panel */
        .header-panel {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px 35px;
            border-radius: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 15px 35px -10px rgba(0, 0, 0, 0.3);
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

            .header-title h2 {
                font-size: 1.6em;
                font-weight: 700;
                color: #fff;
                letter-spacing: -0.5px;
            }

                .header-title h2::before {
                    content: '🛠️ ';
                }

        .btn-logout {
            padding: 12px 25px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s ease;
        }

            .btn-logout:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -10px rgba(231, 76, 60, 0.5);
            }

        /* Main Panel */
        .panel {
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 35px;
            border-radius: 24px;
            box-shadow: 0 20px 40px -15px rgba(0, 0, 0, 0.3);
        }

        /* Tab Buttons */
        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 14px 22px;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s ease;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
            font-family: inherit;
            font-size: 0.95em;
        }

            .tab-btn:hover {
                background: rgba(255, 255, 255, 0.12);
                color: #fff;
                transform: translateY(-2px);
            }

            .tab-btn.active {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #fff;
                border-color: transparent;
                box-shadow: 0 10px 25px -10px rgba(102, 126, 234, 0.5);
            }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

            .tab-content.active {
                display: block;
            }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Section Headers */
        h3 {
            color: #fff;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.4);
        }

        /* Form Elements */
        input,
        textarea,
        select {
            width: 100%;
            padding: 14px 18px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            color: #fff;
            font-family: inherit;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

            input::placeholder,
            textarea::placeholder {
                color: rgba(255, 255, 255, 0.4);
            }

            input:focus,
            textarea:focus {
                outline: none;
                border-color: #667eea;
                background: rgba(255, 255, 255, 0.12);
                box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            }

        /* Buttons */
        button {
            font-family: inherit;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-ekle {
            padding: 14px 28px;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border-radius: 12px;
            margin: 5px;
        }

            .btn-ekle:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -10px rgba(39, 174, 96, 0.5);
            }

        .btn-guncelle {
            padding: 14px 28px;
            background: linear-gradient(135deg, #e67e22 0%, #f39c12 100%);
            color: white;
            border-radius: 12px;
            margin: 5px;
        }

            .btn-guncelle:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -10px rgba(230, 126, 34, 0.5);
            }

        .btn-ara {
            padding: 14px 28px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border-radius: 12px;
            margin: 5px;
        }

            .btn-ara:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -10px rgba(52, 152, 219, 0.5);
            }

        .btn-gunun-kelimesi {
            padding: 14px 28px;
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            border-radius: 12px;
            margin: 5px;
        }

            .btn-gunun-kelimesi:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px -10px rgba(155, 89, 182, 0.5);
            }

        .btn-onayla {
            padding: 8px 16px;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border-radius: 8px;
            font-size: 0.85em;
        }

            .btn-onayla:hover {
                transform: translateY(-1px);
            }

        .btn-reddet {
            padding: 8px 16px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border-radius: 8px;
            font-size: 0.85em;
        }

            .btn-reddet:hover {
                transform: translateY(-1px);
            }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

            table th {
                background: rgba(255, 255, 255, 0.08);
                padding: 16px;
                text-align: left;
                font-weight: 600;
                color: rgba(255, 255, 255, 0.9);
                font-size: 0.9em;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            table td {
                padding: 16px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.06);
                color: rgba(255, 255, 255, 0.85);
            }

            table tr {
                transition: all 0.2s ease;
            }

            table tbody tr:hover {
                background: rgba(255, 255, 255, 0.04);
            }

        /* Mini Box Layout */
        .mini-box {
            display: inline-block;
            width: 48%;
            vertical-align: top;
            margin-right: 2%;
            background: rgba(255, 255, 255, 0.04);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        /* Sub Tab Toggle */
        .sub-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 5px;
            max-width: 400px;
        }

        .sub-tab-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

            .sub-tab-btn:hover {
                color: rgba(255, 255, 255, 0.9);
            }

            .sub-tab-btn.active {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #fff;
                box-shadow: 0 5px 15px -5px rgba(102, 126, 234, 0.5);
            }

        .sub-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
            background: rgba(255, 255, 255, 0.04);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

            .sub-tab-content.active {
                display: block;
            }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 35px;
        }

        .stat-card {
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

            .stat-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(255, 255, 255, 0.1);
                opacity: 0;
                transition: opacity 0.3s ease;
            }

            .stat-card:hover::before {
                opacity: 1;
            }

        .stat-card-1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .stat-card-2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .stat-card-3 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .stat-card-4 {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* Letter Filter Buttons */
        .harf-butonlari {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .harf-btn {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.15);
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            font-family: inherit;
            transition: all 0.3s ease;
        }

            .harf-btn:hover {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border-color: transparent;
                transform: translateY(-2px);
            }

        /* Info Text */
        .info-text {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9em;
            margin-top: 12px;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .badge-warning {
            background: linear-gradient(135deg, #e67e22 0%, #f39c12 100%);
            color: white;
        }

        /* Archive Item */
        .archive-item {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 15px;
            margin: 12px 0;
            border-radius: 12px;
        }

        hr {
            margin: 30px 0;
            border: 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .mini-box {
                width: 100%;
                margin-right: 0;
                margin-bottom: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header-panel {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header-panel">
            <div class="header-title">
                <h2>Yönetici Paneli</h2>
            </div>
            <button class="btn-logout" onclick="cikisYap()">Çıkış Yap</button>
        </div>

        <!-- TAB MENÜ -->
        <div class="panel">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="tabAc('kelimeIslemleri')">📝 Kelime İşlemleri</button>
                <button class="tab-btn" onclick="tabAc('oneriler')">📩 Öneriler</button>
                <button class="tab-btn" onclick="tabAc('ornekCumleler')">💬 Örnek Cümleler</button>
                <button class="tab-btn" onclick="tabAc('kelimeListesi')">📚 Tüm Kelimeler</button>
                <button class="tab-btn" onclick="tabAc('arsiv')">📦 Arşiv</button>
                <button class="tab-btn" onclick="tabAc('gununKelimesi')">⭐ Günün Kelimesi</button>
                <button class="tab-btn" onclick="tabAc('istatistikler')">📊 İstatistikler</button>
            </div>

            <!-- KELIME İŞLEMLERİ TAB -->
            <div id="kelimeIslemleri" class="tab-content active">
                <div class="sub-tabs">
                    <button class="sub-tab-btn active" onclick="subTabAc('ekleTab', this)">➕ Yeni Kelime Ekle</button>
                    <button class="sub-tab-btn" onclick="subTabAc('guncelleTab', this)">✏️ Anlam Güncelle</button>
                </div>

                <div id="ekleTab" class="sub-tab-content active">
                    <h3>Yeni Kelime Ekle</h3>
                    <input type="text" id="yeniKelime" placeholder="Kelime (Örn: Server)">
                    <textarea id="yeniAnlam" placeholder="Anlamı..." rows="4"></textarea>
                    <button class="btn-ekle" onclick="kelimeEkle()">Kelimeyi Kaydet</button>
                </div>

                <div id="guncelleTab" class="sub-tab-content">
                    <h3>Anlam Güncelle</h3>
                    <input type="text" id="guncelKelime" placeholder="Hangi Kelime?">
                    <button class="btn-ara" onclick="kelimeGetir()">Getir</button>
                    <textarea id="guncelAnlam" placeholder="Yeni Anlamı..." rows="4"></textarea>
                    <button class="btn-guncelle" onclick="kelimeGuncelle()">Anlamı Değiştir</button>
                </div>
            </div>

            <!-- ÖNERİLER TAB -->
            <div id="oneriler" class="tab-content">
                <h3>📩 Kullanıcılardan Gelen Öneriler</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Gönderen</th>
                            <th>Kelime</th>
                            <th>Anlam</th>
                            <th>İşlem</th>
                        </tr>
                    </thead>
                    <tbody id="oneriListesiGovdesi"></tbody>
                </table>
                <p id="oneriBilgi" class="info-text">Yükleniyor...</p>
            </div>

            <!-- ÖRNEK CÜMLELER TAB -->
            <div id="ornekCumleler" class="tab-content">
                <h3>💬 Bekleyen Örnek Cümleler</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Kelime</th>
                            <th>Gönderen</th>
                            <th>Cümle</th>
                            <th>İşlem</th>
                        </tr>
                    </thead>
                    <tbody id="ornekCumleListesi"></tbody>
                </table>
                <p id="ornekCumleBilgi" class="info-text">Yükleniyor...</p>
            </div>

            <!-- TÜM KELİMELER TAB -->
            <div id="kelimeListesi" class="tab-content">
                <h3>📚 Tüm Kelimeler</h3>
                <div>
                    <button class="btn-ara" onclick="tumKelimeleriGetir()">Tümünü Göster</button>
                    <span style="margin: 0 15px; color: rgba(255,255,255,0.5);">veya</span>
                    <button class="btn-ara" onclick="harfButonlariniGoster()">Harfe Göre Filtrele</button>
                </div>
                <div id="harfFiltresi" class="harf-butonlari" style="display:none;"></div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Kelime</th>
                            <th>Anlam</th>
                        </tr>
                    </thead>
                    <tbody id="kelimeListesiGovdesi"></tbody>
                </table>
                <p id="kelimeListeBilgi" class="info-text">Listelemek için yukarıdaki butonları kullanın.</p>
            </div>

            <!-- ARŞİV TAB -->
            <div id="arsiv" class="tab-content">
                <h3>📦 Kelime İşlem Arşivi</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Tarih</th>
                            <th>Kelime</th>
                            <th>İşlem</th>
                            <th>Eski Anlam</th>
                            <th>Yeni Anlam</th>
                        </tr>
                    </thead>
                    <tbody id="arsivListesi"></tbody>
                </table>
                <p id="arsivBilgi" class="info-text">Yükleniyor...</p>
            </div>

            <!-- GÜNÜN KELİMESİ TAB -->
            <div id="gununKelimesi" class="tab-content">
                <div class="mini-box">
                    <h3>⭐ Günün Kelimesini Ayarla</h3>
                    <input type="text" id="gununKelimesiInput" placeholder="Kelime">
                    <textarea id="gununKelimesiAnlam" placeholder="Anlamı" rows="4"></textarea>
                    <button class="btn-gunun-kelimesi" onclick="gununKelimesiAyarla()">Kaydet</button>
                </div>

                <div class="mini-box">
                    <h3>📅 Günün Kelimesi Arşivi</h3>
                    <button class="btn-ara" onclick="gununKelimesiArsivGetir()">Arşivi Göster</button>
                    <div id="gununKelimesiArsivAlani" style="margin-top:20px;"></div>
                </div>
            </div>

            <!-- İSTATİSTİKLER TAB -->
            <div id="istatistikler" class="tab-content">
                <h3>📊 Sistem İstatistikleri</h3>

                <!-- Genel İstatistikler -->
                <div class="stats-grid">
                    <div class="stat-card stat-card-1">
                        <div class="stat-value" id="statToplamArama">-</div>
                        <div class="stat-label">Toplam Arama</div>
                    </div>
                    <div class="stat-card stat-card-2">
                        <div class="stat-value" id="statBugunArama">-</div>
                        <div class="stat-label">Bugünkü Aramalar</div>
                    </div>
                    <div class="stat-card stat-card-3">
                        <div class="stat-value" id="statFarkliKelime">-</div>
                        <div class="stat-label">Farklı Kelime</div>
                    </div>
                    <div class="stat-card stat-card-4">
                        <div class="stat-value" id="statAktifKullanici">-</div>
                        <div class="stat-label">Aktif Kullanıcı (24s)</div>
                    </div>
                </div>

                <button class="btn-ara" onclick="istatistikleriGetir()">🔄 İstatistikleri Yenile</button>
                <button class="btn-reddet" onclick="eskiKayitlariTemizle()" style="margin-left: 10px;">
                    🗑️ Eski
                    Kayıtları Temizle (1 yıl+)
                </button>

                <!-- Popüler Kelimeler -->
                <h3 style="margin-top: 35px;">🔥 En Popüler Kelimeler (Son 30 Gün)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Sıra</th>
                            <th>Kelime</th>
                            <th>Arama Sayısı</th>
                            <th>Farklı Kullanıcı</th>
                            <th>Son Arama</th>
                        </tr>
                    </thead>
                    <tbody id="populerKelimelerTablosu"></tbody>
                </table>

                <!-- Bugünün Popülerleri -->
                <h3 style="margin-top: 35px;">⚡ Bugün En Çok Aranananlar</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Sıra</th>
                            <th>Kelime</th>
                            <th>Arama Sayısı</th>
                        </tr>
                    </thead>
                    <tbody id="bugunPopulerlerTablosu"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // TAB SİSTEMİ
        function tabAc(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));

            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');

            // İlgili veriyi yükle
            if (tabId === 'oneriler') onerileriGetir();
            if (tabId === 'ornekCumleler') ornekCumleleriGetir();
            if (tabId === 'arsiv') arsiviGetir();
            if (tabId === 'istatistikler') istatistikleriGetir();
        }

        // SUB TAB SİSTEMİ
        function subTabAc(tabId, btn) {
            document.querySelectorAll('.sub-tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.sub-tab-btn').forEach(b => b.classList.remove('active'));

            document.getElementById(tabId).classList.add('active');
            btn.classList.add('active');
        }

        // KELİME EKLEME
        async function kelimeEkle() {
            const kelime = document.getElementById("yeniKelime").value;
            const anlam = document.getElementById("yeniAnlam").value;

            const response = await fetch('/api/sozluk', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ kelime: kelime, anlam: anlam })
            });

            if (response.ok) {
                alert("Kelime başarıyla eklendi!");
                document.getElementById("yeniKelime").value = "";
                document.getElementById("yeniAnlam").value = "";
            } else {
                alert("Hata: " + await response.text());
            }
        }

        // KELİME GÜNCELLEME
        async function kelimeGuncelle() {
            const kelime = document.getElementById("guncelKelime").value;
            const anlam = document.getElementById("guncelAnlam").value;

            const response = await fetch('/api/sozluk/guncelle', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ kelime: kelime, anlam: anlam })
            });

            if (response.ok) {
                alert("Anlam güncellendi!");
            } else {
                alert("Hata: " + await response.text());
            }
        }

        async function kelimeGetir() {
            const kelime = document.getElementById("guncelKelime").value;
            if (!kelime) { alert("Kelime yazın."); return; }

            const response = await fetch('/api/sozluk/' + kelime);
            if (response.ok) {
                const anlam = await response.text();
                document.getElementById("guncelAnlam").value = anlam;
            } else {
                alert("Kelime bulunamadı.");
                document.getElementById("guncelAnlam").value = "";
            }
        }

        // ÖNERİLER
        async function onerileriGetir() {
            const tabloGovdesi = document.getElementById("oneriListesiGovdesi");
            const bilgi = document.getElementById("oneriBilgi");

            tabloGovdesi.innerHTML = "";
            bilgi.innerText = "Yükleniyor...";

            try {
                const response = await fetch('/api/sozluk/oneriler/bekleyen');
                const veriler = await response.json();

                if (veriler.length === 0) {
                    bilgi.innerText = "Bekleyen öneri yok.";
                    return;
                }

                bilgi.style.display = "none";

                veriler.forEach(veri => {
                    const satir = document.createElement("tr");
                    satir.innerHTML = `
                            <td><b>${veri.gonderen}</b></td>
                            <td style="color:#667eea;">${veri.kelime}</td>
                            <td>${veri.anlam}</td>
                            <td>
                                <button class="btn-onayla" onclick="oneriOnayla(${veri.id})">✓ Onayla</button>
                                <button class="btn-reddet" onclick="oneriReddet(${veri.id})">✗ Reddet</button>
                            </td>
                        `;
                    tabloGovdesi.appendChild(satir);
                });

            } catch (err) {
                bilgi.innerText = "Hata: " + err;
            }
        }

        async function oneriOnayla(id) {
            if (!confirm("Bu öneriyi onaylayıp sözlüğe eklemek istiyor musunuz?")) return;

            try {
                const response = await fetch('/api/admin/oneri/onayla/' + id, { method: 'POST' });
                if (response.ok) {
                    alert(await response.text());
                    onerileriGetir();
                } else {
                    alert("Hata: " + await response.text());
                }
            } catch (err) {
                alert("Bağlantı hatası: " + err);
            }
        }

        async function oneriReddet(id) {
            if (!confirm("Bu öneriyi reddetmek istiyor musunuz?")) return;

            try {
                const response = await fetch('/api/admin/oneri/reddet/' + id, { method: 'DELETE' });
                if (response.ok) {
                    alert(await response.text());
                    onerileriGetir();
                } else {
                    alert("Hata: " + await response.text());
                }
            } catch (err) {
                alert("Bağlantı hatası: " + err);
            }
        }

        // ÖRNEK CÜMLELER
        async function ornekCumleleriGetir() {
            const liste = document.getElementById("ornekCumleListesi");
            const bilgi = document.getElementById("ornekCumleBilgi");

            liste.innerHTML = "";
            bilgi.innerText = "Yükleniyor...";

            try {
                const response = await fetch('/api/admin/ornek-cumleler/bekleyen');
                const veriler = await response.json();

                if (veriler.length === 0) {
                    bilgi.innerText = "Bekleyen örnek cümle yok.";
                    return;
                }

                bilgi.style.display = "none";

                veriler.forEach(veri => {
                    const satir = document.createElement("tr");
                    satir.innerHTML = `
                            <td><b>${veri.kelime}</b></td>
                            <td>${veri.gonderen}</td>
                            <td>${veri.cumle}</td>
                            <td>
                                <button class="btn-onayla" onclick="ornekCumleOnayla(${veri.id})">✓ Onayla</button>
                                <button class="btn-reddet" onclick="ornekCumleReddet(${veri.id})">✗ Reddet</button>
                            </td>
                        `;
                    liste.appendChild(satir);
                });
            } catch (err) {
                bilgi.innerText = "Hata: " + err;
            }
        }

        async function ornekCumleOnayla(id) {
            try {
                const response = await fetch('/api/admin/ornek-cumle/onayla/' + id, { method: 'POST' });
                if (response.ok) {
                    alert("Örnek cümle onaylandı.");
                    ornekCumleleriGetir();
                } else {
                    alert("Hata: " + await response.text());
                }
            } catch (err) {
                alert("Bağlantı hatası: " + err);
            }
        }

        async function ornekCumleReddet(id) {
            try {
                const response = await fetch('/api/admin/ornek-cumle/reddet/' + id, { method: 'DELETE' });
                if (response.ok) {
                    alert("Örnek cümle reddedildi.");
                    ornekCumleleriGetir();
                } else {
                    alert("Hata: " + await response.text());
                }
            } catch (err) {
                alert("Bağlantı hatası: " + err);
            }
        }

        // TÜM KELİMELER
        async function tumKelimeleriGetir(harf = null) {
            const liste = document.getElementById("kelimeListesiGovdesi");
            const bilgi = document.getElementById("kelimeListeBilgi");

            liste.innerHTML = "";
            bilgi.innerText = "Yükleniyor...";

            try {
                let url = '/api/admin/kelimeler';
                if (harf) url += '?harf=' + harf;

                const response = await fetch(url);
                const veriler = await response.json();

                if (veriler.length === 0) {
                    bilgi.innerText = "Kelime bulunamadı.";
                    return;
                }

                bilgi.innerText = `Toplam ${veriler.length} kelime listeleniyor.`;

                veriler.forEach(veri => {
                    const satir = document.createElement("tr");
                    satir.innerHTML = `
                            <td>${veri.id}</td>
                            <td><b>${veri.kelime}</b></td>
                            <td>${veri.anlam.substring(0, 100)}${veri.anlam.length > 100 ? '...' : ''}</td>
                        `;
                    liste.appendChild(satir);
                });
            } catch (err) {
                bilgi.innerText = "Hata: " + err;
            }
        }

        function harfButonlariniGoster() {
            const alan = document.getElementById("harfFiltresi");
            if (alan.style.display === "none" || alan.innerHTML === "") {
                alan.style.display = "flex";
                alan.innerHTML = "";

                "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(harf => {
                    const btn = document.createElement("button");
                    btn.className = "harf-btn";
                    btn.innerText = harf;
                    btn.onclick = () => tumKelimeleriGetir(harf);
                    alan.appendChild(btn);
                });
            } else {
                alan.style.display = "none";
            }
        }

        // ARŞİV
        async function arsiviGetir() {
            const liste = document.getElementById("arsivListesi");
            const bilgi = document.getElementById("arsivBilgi");

            liste.innerHTML = "";
            bilgi.innerText = "Yükleniyor...";

            try {
                const response = await fetch('/api/admin/arsiv');
                const veriler = await response.json();

                if (veriler.length === 0) {
                    bilgi.innerText = "Arşiv boş.";
                    return;
                }

                bilgi.style.display = "none";

                veriler.forEach(veri => {
                    const satir = document.createElement("tr");
                    satir.innerHTML = `
                            <td>${veri.tarih}</td>
                            <td><b>${veri.kelime}</b></td>
                            <td><span class="badge badge-warning">${veri.islem}</span></td>
                            <td>${veri.eskiAnlam || '-'}</td>
                            <td>${veri.yeniAnlam}</td>
                        `;
                    liste.appendChild(satir);
                });
            } catch (err) {
                bilgi.innerText = "Hata: " + err;
            }
        }

        // GÜNÜN KELİMESİ
        async function gununKelimesiAyarla() {
            const kelime = document.getElementById("gununKelimesiInput").value;
            const anlam = document.getElementById("gununKelimesiAnlam").value;

            if (!kelime || !anlam) {
                alert("Lütfen kelime ve anlamını girin.");
                return;
            }

            try {
                const response = await fetch('/api/admin/gunun-kelimesi', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ Kelime: kelime, Anlam: anlam })
                });

                if (response.ok) {
                    alert(await response.text());
                    document.getElementById("gununKelimesiInput").value = "";
                    document.getElementById("gununKelimesiAnlam").value = "";
                } else {
                    alert("Hata: " + await response.text());
                }
            } catch (err) {
                alert("Bağlantı hatası: " + err);
            }
        }

        async function gununKelimesiArsivGetir() {
            const alan = document.getElementById("gununKelimesiArsivAlani");
            alan.innerHTML = "Yükleniyor...";

            try {
                const response = await fetch('/api/sozluk/gunun-kelimesi/arsiv');
                const veriler = await response.json();

                if (veriler.length === 0) {
                    alan.innerHTML = "Henüz günün kelimesi arşivi yok.";
                    return;
                }

                alan.innerHTML = "";
                veriler.forEach(veri => {
                    const div = document.createElement("div");
                    div.className = "archive-item";
                    div.innerHTML = `
                            <strong style="color:#9b59b6;">${veri.tarih}</strong><br>
                            <strong>${veri.kelime}</strong>: ${veri.anlam}
                        `;
                    alan.appendChild(div);
                });
            } catch (err) {
                alan.innerHTML = "Hata: " + err;
            }
        }

        function cikisYap() {
            localStorage.clear();
            window.location.href = "giris.html";
        }

        // İSTATİSTİKLER
        async function istatistikleriGetir() {
            try {
                // Genel istatistikleri getir
                const statResponse = await fetch('/api/arama/istatistik');
                const stats = await statResponse.json();

                document.getElementById("statToplamArama").innerText = stats.toplamAramaSayisi.toLocaleString();
                document.getElementById("statBugunArama").innerText = stats.bugunkuAramalar.toLocaleString();
                document.getElementById("statFarkliKelime").innerText = stats.farkliKelimelSayisi.toLocaleString();
                document.getElementById("statAktifKullanici").innerText = stats.aktifKullaniciSayisi24Saat.toLocaleString();

                // Popüler kelimeleri getir
                const populerResponse = await fetch('/api/arama/populer?limit=20&gunSayisi=30');
                const populerler = await populerResponse.json();

                const populerTablo = document.getElementById("populerKelimelerTablosu");
                populerTablo.innerHTML = "";

                populerler.forEach((item, index) => {
                    let medal = "";
                    if (index === 0) medal = "🥇";
                    else if (index === 1) medal = "🥈";
                    else if (index === 2) medal = "🥉";

                    const satir = document.createElement("tr");
                    satir.innerHTML = `
                            <td>${medal} ${index + 1}</td>
                            <td><strong>${item.kelime}</strong></td>
                            <td>${item.aramaSayisi}</td>
                            <td>${item.farkliKullaniciSayisi}</td>
                            <td>${item.sonArama}</td>
                        `;
                    populerTablo.appendChild(satir);
                });

                // Bugünün popülerlerini getir
                const bugunResponse = await fetch('/api/arama/populer/bugun?limit=10');
                const bugunPopuler = await bugunResponse.json();

                const bugunTablo = document.getElementById("bugunPopulerlerTablosu");
                bugunTablo.innerHTML = "";

                if (bugunPopuler.length === 0) {
                    bugunTablo.innerHTML = "<tr><td colspan='3' style='text-align:center; color:rgba(255,255,255,0.5);'>Bugün henüz arama yapılmamış.</td></tr>";
                } else {
                    bugunPopuler.forEach((item, index) => {
                        let medal = "";
                        if (index === 0) medal = "🥇";
                        else if (index === 1) medal = "🥈";
                        else if (index === 2) medal = "🥉";

                        const satir = document.createElement("tr");
                        satir.innerHTML = `
                                <td>${medal} ${index + 1}</td>
                                <td><strong>${item.kelime}</strong></td>
                                <td>${item.aramaSayisi}</td>
                            `;
                        bugunTablo.appendChild(satir);
                    });
                }

            } catch (err) {
                alert("İstatistikler yüklenirken hata oluştu: " + err);
            }
        }

        async function eskiKayitlariTemizle() {
            if (!confirm("1 yıldan eski tüm arama kayıtları silinecek. Emin misiniz?")) return;

            try {
                const response = await fetch('/api/arama/temizlik', { method: 'DELETE' });
                if (response.ok) {
                    alert(await response.text());
                    istatistikleriGetir();
                }
            } catch (err) {
                alert("Hata: " + err);
            }
        }

        // Sayfa yüklendiğinde önerileri getir
        document.addEventListener("DOMContentLoaded", function () {
            onerileriGetir();
        });
    </script>
</body>

</html>